<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
	</head>
	<body>
		<script type="text/javascript">
			window.onload = function () {
				function getParameterByName(name, url = window.location.href) {
					name = name.replace(/[\[\]]/g, '\\$&');
					var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
						results = regex.exec(url);
					if (!results) return null;
					if (!results[2]) return '';
					return decodeURIComponent(results[2].replace(/\+/g, ' '));
				}

				var youtubeLongLink = 'www.youtube.com/watch?v=';
				var youtubeShortLink = 'https://youtu.be/';
				var https = 'https://';
				var www = 'www.';
				var appFallback = getParameterByName('u');

				if (!appFallback) return;
				else if (appFallback.includes(youtubeShortLink)) {
					appFallback = youtubeLongURL + appFallback.split(youtubeShortLink)[1];
				} else if (appFallback.includes(https)) {
					if (appFallback.includes(www))
						appFallback = appFallback.replace((https, ''));
					else appFallback = appFallback.replace(https, www);
				} else if (!appFallback.includes(www)) {
					appFallback = youtubeLong + appFallback;
				}

				var androidApp = `intent://${appFallback}#Intent;package=com.google.android.youtube;scheme=https;end`;
				var iosApp = `vnd.youtube://${appFallback}`;

				if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
					window.location.href = iosApp;
					window.setTimeout(function () {
						window.location.href = appFallback;
					}, 25);
				} else if (/Android/i.test(navigator.userAgent)) {
					window.location.href = androidApp;
					window.setTimeout(function () {
						window.location.href = appFallback;
					}, 25);
				} else {
					window.location.href = appFallback;
				}

				function killPopup() {
					window.removeEventListener('pagehide', killPopup);
				}

				window.addEventListener('pagehide', killPopup);
			};
		</script>
	</body>
</html>
